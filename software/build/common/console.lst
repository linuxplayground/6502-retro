ca65 V2.18 - Ubuntu 2.18-1
Main file   : common/src/console.s
Current file: common/src/console.s

000000r 1                       .include "sysram.inc"
000000r 2                       .import con_buf
000000r 2                       .import Rbuff
000000r 2                       .import wozmon_buf
000000r 2               
000000r 1                       .include "acia.inc"
000000r 2                       .import _acia_init
000000r 2                       .import _acia_read_byte
000000r 2                       .import _acia_read_byte_nw
000000r 2                       .import _acia_write_byte
000000r 2                       .import ACIA_STATUS
000000r 2                       .import ACIA_DATA
000000r 2               
000000r 1                       .include "console_macros.inc"
000000r 2               .macro mac_con_print addr
000000r 2                       lda #<addr
000000r 2                       sta str_ptr
000000r 2                       lda #>addr
000000r 2                       sta str_ptr + 1
000000r 2                       jsr _con_print
000000r 2               .endmacro
000000r 2               
000000r 1                       .include "zeropage.inc"
000000r 2                       .globalzp usr_irq
000000r 2                       .globalzp con_r_idx
000000r 2                       .globalzp con_w_idx
000000r 2                       .globalzp str_ptr
000000r 2                       .globalzp tmp1
000000r 2                       .globalzp crc
000000r 2                       .globalzp crch
000000r 2                       .globalzp ptr
000000r 2                       .globalzp ptrh
000000r 2                       .globalzp blkno
000000r 2                       .globalzp retry
000000r 2                       .globalzp retry2
000000r 2                       .globalzp bflag
000000r 2                       .globalzp XAML
000000r 2                       .globalzp XAMH
000000r 2                       .globalzp STL
000000r 2                       .globalzp STH
000000r 2                       .globalzp L
000000r 2                       .globalzp H
000000r 2                       .globalzp YSAV
000000r 2                       .globalzp MODE
000000r 2                       .globalzp MSGL
000000r 2                       .globalzp MSGH
000000r 2               
000000r 1               
000000r 1                       .export _con_init
000000r 1                       .export _con_in
000000r 1                       .export _con_out
000000r 1                       .export _con_prompt
000000r 1                       .export _con_nl
000000r 1                       .export _con_print
000000r 1                       .export _con_nl
000000r 1               
000000r 1                       .code
000000r 1               
000000r 1               _con_init:
000000r 1  64 rr                stz con_r_idx
000002r 1  64 rr                stz con_w_idx
000004r 1  60                   rts
000005r 1               
000005r 1               _con_in:
000005r 1  DA                   phx
000006r 1  78                   sei
000007r 1  A5 rr                lda con_r_idx
000009r 1  C5 rr                cmp con_w_idx
00000Br 1  58                   cli
00000Cr 1  F0 09                beq @no_data
00000Er 1  AA                   tax
00000Fr 1  BD rr rr             lda con_buf,x
000012r 1  E6 rr                inc con_r_idx
000014r 1  38                   sec
000015r 1  FA                   plx
000016r 1  60                   rts
000017r 1               @no_data:
000017r 1  18                   clc
000018r 1  FA                   plx
000019r 1  60                   rts
00001Ar 1               
00001Ar 1               _con_out:
00001Ar 1  20 rr rr             jsr _acia_write_byte
00001Dr 1  60                   rts
00001Er 1               
00001Er 1               _con_prompt:
00001Er 1  A9 rr 85 rr          mac_con_print str_prompt
000022r 1  A9 rr 85 rr  
000026r 1  20 rr rr     
000029r 1  60                   rts
00002Ar 1               
00002Ar 1               _con_nl:
00002Ar 1  A9 rr 85 rr          mac_con_print str_nl
00002Er 1  A9 rr 85 rr  
000032r 1  20 rr rr     
000035r 1  60                   rts
000036r 1               
000036r 1               _con_print:
000036r 1  A0 00                ldy #0
000038r 1               @loop:
000038r 1  B1 rr                lda (str_ptr),y
00003Ar 1  F0 07                beq @return
00003Cr 1  20 rr rr             jsr _con_out
00003Fr 1  C8                   iny
000040r 1  4C rr rr             jmp @loop
000043r 1               @return:
000043r 1  60                   rts
000044r 1               
000044r 1                       .rodata
000000r 1               str_prompt:
000000r 1  3E 20 00             .asciiz "> "
000003r 1               
000003r 1  0A 0D 00     str_nl: .byte $0a,$0d,$00
000005r 1               
